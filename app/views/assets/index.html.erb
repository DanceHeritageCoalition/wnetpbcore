<%- title(@query ? "Search for #{@query}" : "Assets") -%>
<%= render :partial => 'search_form' %>

<%- if @assets.empty? -%>
<h2>Nothing found.</h2>
<%- else -%>
<p>
  <span id="record_count">Showing records <strong><%= @search_object.offset + 1 %></strong>â€“<strong><%= @search_object.offset + @assets.size %></strong> of <strong><%= @search_object.total_entries %></strong>.</span>
  <%= link_to_remote "#{session[:hide_annotations] ? "show" : "hide"} annotations", :url => { :action => "toggleannotations" }, :html => { :id => "toggle_annotations_link", :href => url_for(:action => "toggleannotations") }, :method => :get %>
</p>
<ul>
  <%- @assets.each do |asset| -%>
    <li class="asset-summary" id="asset_<%= asset.id %>">
      <%= h asset.identifier %>
      <%= link_to "view", asset_url(asset.uuid) if authorized?('show', asset) %>
      <%= link_to "xml", formatted_asset_url(asset.uuid, "xml") if authorized?('show', asset) %>
      <%= link_to "edit", edit_asset_url(asset) if authorized?('edit', asset) %>
      <%= link_to_remote "destroy", :url => { :action => 'destroy', :id => asset.id }, :method => :delete, :confirm => "Are you sure you wish to delete #{asset.title}?", :html => { :class => "destroy_link" } if authorized?('destroy', asset)%>
      <br />
      <strong><%= h asset.title %></strong>
      <ul>
        <%- asset.instantiations.each do |instantiation| -%>
          <li>
            <%= h instantiation.summary %>
            <span class="annotations" style="<%= "display: none;" if session[:hide_annotations] %>"><%= h instantiation.annotation %></span>
            <%- if instantiation.format_location =~ /^(f|ht)tp:\/\// -%>
              <%= link_to "[link]", instantiation.format_location %>
            <%- end -%>
          </li>
        <%- end -%>
      </ul>
    </li>
  <%- end -%>
</ul>

<%= will_paginate @search_object %>
<p><%= link_to "download results as zipfile", :action => 'zip', :q => @query %></p>
<%- end -%>
