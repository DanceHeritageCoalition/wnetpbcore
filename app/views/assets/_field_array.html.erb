<%-
if (local_assigns[:key].nil? && !objs.empty?)
  -%>
  <dt><%= h field %></dt>
  <%-
end
objs.each do |obj|
  if local_assigns[:key]
    objkey = obj.send(key)
    objkey = objkey.name if objkey.respond_to?(:name)
    keystr = "#{field} (#{objkey})"
    -%>
    <dt><%= h keystr %></dt>
    <%-
  end
  query = nil
  unless local_assigns[:searchkey].nil?
    query = "@#{local_assigns[:searchkey].to_s} \""
    if local_assigns[:searchxtra]
      xtra = obj.send(searchxtra)
      query += "#{xtra.name} " unless xtra.nil?
    end
    query += obj.send(local_assigns[:searchvalue] || value)
    query += '"'
  end
-%>
  <dd><%= link_to_unless(local_assigns[:searchkey].nil?, h(obj.send(value)).gsub(/[\r\n]+/, "<br />"),
            { :action => 'index', :q => query })
  %></dd>
<%-
end
-%>
